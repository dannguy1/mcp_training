{% extends "base.html" %}

{% block title %}Settings - MCP Training Service{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2 class="mb-4">Settings</h2>
    </div>
</div>

<!-- Settings Layout with Left Sidebar Tabs -->
<div class="row">
    <!-- Left Sidebar Navigation -->
    <div class="col-md-3 col-lg-2">
        <div class="settings-sidebar">
            <div class="nav flex-column nav-pills" id="settingsTabs" role="tablist" aria-orientation="vertical">
                <button class="nav-link active" id="general-tab" data-bs-toggle="pill" data-bs-target="#general" type="button" role="tab">
                    <i class="bi bi-gear me-2"></i>
                    General
                </button>
                <button class="nav-link" id="training-tab" data-bs-toggle="pill" data-bs-target="#training" type="button" role="tab">
                    <i class="bi bi-cpu me-2"></i>
                    Training
                </button>
                <button class="nav-link" id="storage-tab" data-bs-toggle="pill" data-bs-target="#storage" type="button" role="tab">
                    <i class="bi bi-hdd me-2"></i>
                    Storage
                </button>
                <button class="nav-link" id="logging-tab" data-bs-toggle="pill" data-bs-target="#logging" type="button" role="tab">
                    <i class="bi bi-file-text me-2"></i>
                    Logging
                </button>
                <button class="nav-link" id="security-tab" data-bs-toggle="pill" data-bs-target="#security" type="button" role="tab">
                    <i class="bi bi-shield me-2"></i>
                    Security
                </button>
                <button class="nav-link" id="advanced-tab" data-bs-toggle="pill" data-bs-target="#advanced" type="button" role="tab">
                    <i class="bi bi-tools me-2"></i>
                    Advanced
                </button>
            </div>
        </div>
    </div>
    
    <!-- Main Content Area -->
    <div class="col-md-9 col-lg-10">
        <div class="tab-content" id="settingsTabContent">
            <!-- General Settings -->
            <div class="tab-pane fade show active" id="general" role="tabpanel">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">General Settings</h6>
                    </div>
                    <div class="card-body">
                        <form id="generalSettingsForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="serviceName" class="form-label">Service Name</label>
                                        <input type="text" class="form-control" id="serviceName" value="MCP Training Service">
                                        <div class="form-text">Display name for the service.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="serviceVersion" class="form-label">Service Version</label>
                                        <input type="text" class="form-control" id="serviceVersion" value="1.0.0" readonly>
                                        <div class="form-text">Current service version.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="timezone" class="form-label">Timezone</label>
                                        <select class="form-select" id="timezone">
                                            <option value="UTC">UTC</option>
                                            <option value="America/New_York">Eastern Time</option>
                                            <option value="America/Chicago">Central Time</option>
                                            <option value="America/Denver">Mountain Time</option>
                                            <option value="America/Los_Angeles">Pacific Time</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="dateFormat" class="form-label">Date Format</label>
                                        <select class="form-select" id="dateFormat">
                                            <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                            <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                            <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="autoRefresh" checked>
                                    <label class="form-check-label" for="autoRefresh">
                                        Enable auto-refresh on dashboard
                                    </label>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="notifications" checked>
                                    <label class="form-check-label" for="notifications">
                                        Enable browser notifications
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Training Settings -->
            <div class="tab-pane fade" id="training" role="tabpanel">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">Training Configuration</h6>
                    </div>
                    <div class="card-body">
                        <form id="trainingSettingsForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="maxConcurrentJobs" class="form-label">Max Concurrent Jobs</label>
                                        <input type="number" class="form-control" id="maxConcurrentJobs" value="3" min="1" max="10">
                                        <div class="form-text">Maximum number of training jobs that can run simultaneously.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="defaultMaxIterations" class="form-label">Default Max Iterations</label>
                                        <input type="number" class="form-control" id="defaultMaxIterations" value="1000" min="100" max="10000">
                                        <div class="form-text">Default maximum training iterations for new jobs.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="defaultLearningRate" class="form-label">Default Learning Rate</label>
                                        <input type="number" class="form-control" id="defaultLearningRate" value="0.01" step="0.001" min="0.001" max="1">
                                        <div class="form-text">Default learning rate for training.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="jobTimeout" class="form-label">Job Timeout (hours)</label>
                                        <input type="number" class="form-control" id="jobTimeout" value="24" min="1" max="168">
                                        <div class="form-text">Maximum time a training job can run before being cancelled.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="defaultConfig" class="form-label">Default Configuration</label>
                                <textarea class="form-control" id="defaultConfig" rows="4" placeholder='{"algorithm": "random_forest", "n_estimators": 100}'>{"algorithm": "random_forest", "n_estimators": 100, "max_depth": 10}</textarea>
                                <div class="form-text">Default model configuration in JSON format.</div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Storage Settings -->
            <div class="tab-pane fade" id="storage" role="tabpanel">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">Storage Configuration</h6>
                    </div>
                    <div class="card-body">
                        <form id="storageSettingsForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="modelsDir" class="form-label">Models Directory</label>
                                        <input type="text" class="form-control" id="modelsDir" value="models">
                                        <div class="form-text">Directory to store trained models.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="exportsDir" class="form-label">Exports Directory</label>
                                        <input type="text" class="form-control" id="exportsDir" value="exports">
                                        <div class="form-text">Directory to store export files.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="logsDir" class="form-label">Logs Directory</label>
                                        <input type="text" class="form-control" id="logsDir" value="logs">
                                        <div class="form-text">Directory to store log files.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="maxStorageGB" class="form-label">Max Storage (GB)</label>
                                        <input type="number" class="form-control" id="maxStorageGB" value="10" min="1" max="1000">
                                        <div class="form-text">Maximum storage usage in gigabytes.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="autoCleanup" checked>
                                    <label class="form-check-label" for="autoCleanup">
                                        Enable automatic cleanup of old files
                                    </label>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="retentionDays" class="form-label">Retention Period (days)</label>
                                <input type="number" class="form-control" id="retentionDays" value="30" min="1" max="365">
                                <div class="form-text">Number of days to keep old files before cleanup.</div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Logging Settings -->
            <div class="tab-pane fade" id="logging" role="tabpanel">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">Logging Configuration</h6>
                    </div>
                    <div class="card-body">
                        <form id="loggingSettingsForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="logLevel" class="form-label">Log Level</label>
                                        <select class="form-select" id="logLevel">
                                            <option value="DEBUG">DEBUG</option>
                                            <option value="INFO" selected>INFO</option>
                                            <option value="WARNING">WARNING</option>
                                            <option value="ERROR">ERROR</option>
                                        </select>
                                        <div class="form-text">Minimum log level to record.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="logFormat" class="form-label">Log Format</label>
                                        <select class="form-select" id="logFormat">
                                            <option value="structured" selected>Structured (JSON)</option>
                                            <option value="simple">Simple</option>
                                            <option value="detailed">Detailed</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="logFile" class="form-label">Log File</label>
                                        <input type="text" class="form-control" id="logFile" value="logs/mcp_training.log">
                                        <div class="form-text">Path to log file.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="maxLogSizeMB" class="form-label">Max Log Size (MB)</label>
                                        <input type="number" class="form-control" id="maxLogSizeMB" value="100" min="1" max="1000">
                                        <div class="form-text">Maximum size of log file before rotation.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="logToConsole" checked>
                                    <label class="form-check-label" for="logToConsole">
                                        Log to console
                                    </label>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="logToFile" checked>
                                    <label class="form-check-label" for="logToFile">
                                        Log to file
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Security Settings -->
            <div class="tab-pane fade" id="security" role="tabpanel">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">Security Configuration</h6>
                    </div>
                    <div class="card-body">
                        <form id="securitySettingsForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="authEnabled" class="form-label">Authentication</label>
                                        <select class="form-select" id="authEnabled">
                                            <option value="false" selected>Disabled</option>
                                            <option value="true">Enabled</option>
                                        </select>
                                        <div class="form-text">Enable authentication for API access.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="apiKey" class="form-label">API Key</label>
                                        <input type="password" class="form-control" id="apiKey" placeholder="Enter API key">
                                        <div class="form-text">API key for authentication.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="corsOrigins" class="form-label">CORS Origins</label>
                                        <input type="text" class="form-control" id="corsOrigins" placeholder="http://localhost:3000,https://example.com">
                                        <div class="form-text">Comma-separated list of allowed origins.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="rateLimit" class="form-label">Rate Limit (requests/min)</label>
                                        <input type="number" class="form-control" id="rateLimit" value="100" min="10" max="1000">
                                        <div class="form-text">Maximum requests per minute per client.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="httpsOnly">
                                    <label class="form-check-label" for="httpsOnly">
                                        Require HTTPS
                                    </label>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="secureHeaders" checked>
                                    <label class="form-check-label" for="secureHeaders">
                                        Enable security headers
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Advanced Settings -->
            <div class="tab-pane fade" id="advanced" role="tabpanel">
                <div class="card">
                    <div class="card-header">
                        <h6 class="mb-0">Advanced Configuration</h6>
                    </div>
                    <div class="card-body">
                        <form id="advancedSettingsForm">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="debugMode" class="form-label">Debug Mode</label>
                                        <select class="form-select" id="debugMode">
                                            <option value="false" selected>Disabled</option>
                                            <option value="true">Enabled</option>
                                        </select>
                                        <div class="form-text">Enable debug mode for development.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="performanceMonitoring" class="form-label">Performance Monitoring</label>
                                        <select class="form-select" id="performanceMonitoring">
                                            <option value="true" selected>Enabled</option>
                                            <option value="false">Disabled</option>
                                        </select>
                                        <div class="form-text">Enable performance monitoring and metrics.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="websocketEnabled" class="form-label">WebSocket</label>
                                        <select class="form-select" id="websocketEnabled">
                                            <option value="true" selected>Enabled</option>
                                            <option value="false">Disabled</option>
                                        </select>
                                        <div class="form-text">Enable WebSocket for real-time updates.</div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="autoBackup" class="form-label">Auto Backup</label>
                                        <select class="form-select" id="autoBackup">
                                            <option value="false" selected>Disabled</option>
                                            <option value="true">Enabled</option>
                                        </select>
                                        <div class="form-text">Enable automatic backup of models and data.</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-3">
                                <label for="customConfig" class="form-label">Custom Configuration</label>
                                <textarea class="form-control" id="customConfig" rows="6" placeholder='{"custom_setting": "value"}'>{"custom_setting": "value"}</textarea>
                                <div class="form-text">Additional configuration in JSON format.</div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Action Buttons -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div class="d-flex justify-content-between">
                    <button type="button" class="btn btn-secondary" onclick="app.resetSettings()">
                        <i class="bi bi-arrow-clockwise me-2"></i>
                        Reset to Defaults
                    </button>
                    <div>
                        <button type="button" class="btn btn-outline-secondary me-2" onclick="app.exportSettings()">
                            <i class="bi bi-download me-2"></i>
                            Export Settings
                        </button>
                        <button type="button" class="btn btn-primary" onclick="app.saveSettings()">
                            <i class="bi bi-check me-2"></i>
                            Save Settings
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Import Settings Modal -->
<div class="modal fade" id="importSettingsModal" tabindex="-1" aria-labelledby="importSettingsModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="importSettingsModalLabel">Import Settings</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label for="settingsFile" class="form-label">Settings File</label>
                    <input type="file" class="form-control" id="settingsFile" accept=".json">
                    <div class="form-text">Select a JSON settings file to import.</div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="app.importSettings()">
                    <i class="bi bi-upload me-2"></i>
                    Import Settings
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', path='/js/settings.js') }}"></script>
{% endblock %} 